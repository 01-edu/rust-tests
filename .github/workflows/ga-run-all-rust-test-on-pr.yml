name: GA-Run-All-Rust-Test-On-PR

on:
  pull_request:
    branches: ['master']
  workflow_run:
    workflows: ['Docker Image On Branch CI']
    types:
      - completed

env:
  BRANCH_ID: ${{ github.event.pull_request.number }}

jobs:
  GA-All-Rust-Test-On-PR:
    runs-on: ga-test-runner-check-rust-tests
    steps:
      - name: 🐧 Checkout
        uses: actions/checkout@v3
        with:
          ssh: ${{ secrets.ACTIONS_DEPLOY_KEY }}

      - name: 📜 Launch script with branch  $BRANCH_ID
        run: |
          ./tests/test_exercises.sh \
          -real \
          -n \
          -pull-from \
          test-rust:PR${{ github.event.pull_request.number }}
